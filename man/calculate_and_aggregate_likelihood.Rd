% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ageDensity.R
\name{calculate_and_aggregate_likelihood}
\alias{calculate_and_aggregate_likelihood}
\title{Calculate and Aggregate Signed Log-Likelihood Contributions}
\usage{
calculate_and_aggregate_likelihood(
  surveys,
  G,
  a,
  l,
  mu,
  kappa,
  annuli_date,
  annuli_min_age
)
}
\arguments{
\item{surveys}{A data frame with survey age-at-length observations with
columns \code{survey_date}, \code{Length}, \code{K}, and \code{count}.}

\item{G}{Greens function matrix (rows = ages, cols = length classes).}

\item{a}{Numeric vector of high-resolution ages corresponding to rows of \code{G}.}

\item{l}{Numeric vector of lengths corresponding to columns of \code{G}.}

\item{mu}{Mean spawning date as a fraction of a year in [0, 1).}

\item{kappa}{Spawning concentration parameter.}

\item{annuli_date}{Ring formation day as fraction of a year in [0, 1).}

\item{annuli_min_age}{Minimum age (years) at which the first ring can form.}
}
\value{
A data frame containing, for each observed Length-K bin in each
survey, the observed count, expected count under the model, model
probability, sample size, negative log-likelihood contribution, and signed
negative log-likelihood contribution.
}
\description{
Loops through surveys, calculates signed NLL for each, and aggregates the
results.
}
